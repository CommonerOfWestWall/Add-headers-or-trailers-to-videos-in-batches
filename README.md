### **软件使用说明：视频批量处理器**

---

#### **功能概述**
本软件用于批量处理视频文件，支持以下功能：
1. **添加片头/片尾视频**：可以为指定的视频批量添加片头、片尾或同时添加。
2. **视频预处理**：支持调整视频分辨率、帧率、宽高比（SAR），确保输出统一规范。
3. **GPU加速支持**：支持不同类型的显卡（NVIDIA、AMD、Intel、集成显卡），提供快速编码。
4. **自定义参数**：支持用户自定义输出分辨率、帧率、码率等。
5. **屏幕方向调整**：支持横屏和竖屏模式，适配不同设备需求。

---

#### **软件界面说明**

1. **选择视频文件夹**：
   - 用于选择包含主视频文件的文件夹，支持 `*.mp4`, `*.mkv`, `*.avi` 格式。
   - 所有主视频将从该文件夹中读取进行批量处理。

2. **选择类型**：
   - **片头**：只添加片头视频。
   - **片尾**：只添加片尾视频。
   - **同时添加片头片尾**：同时添加片头和片尾视频。

3. **选择屏幕方向**：
   - 横屏：输出宽高比为横向。
   - 竖屏：输出宽高比为竖向。

4. **选择片头/片尾视频**：
   - **片头视频**：选择需要添加到主视频开头的文件。
   - **片尾视频**：选择需要添加到主视频结尾的文件。

5. **选择显卡类型**：
   - 支持 `N卡`（NVIDIA显卡）、`A卡`（AMD显卡）、`I卡`（Intel显卡）和 `集成显卡`。

6. **自定义码率**：
   - 设置输出视频的码率（单位：kbps）。
   - 例如：1100 表示视频码率为 1100 kbps。

7. **自定义分辨率**：
   - 提供 `720p`、`1080p`、`4k` 等分辨率选项。

8. **设置帧率**：
   - 自定义输出视频帧率，支持特殊帧率（如 23.97、60 等）。

9. **选择输出文件夹**：
   - 设置输出文件的存储位置。

10. **开始按钮**：
    - 开始处理视频文件，进度会动态显示在状态标签中。

11. **状态标签**：
    - 实时显示当前处理状态，例如“正在处理片头”、“正在合成视频”等。

---

#### **使用步骤**

1. **启动软件**：
   双击程序，启动主界面。

2. **选择主视频文件夹**：
   - 点击“浏览”按钮，选择存储主视频的文件夹。
   - 确保文件夹中只包含需要处理的主视频文件。

3. **选择片头/片尾文件**：
   - 根据需要选择片头或片尾视频文件（支持单独添加片头、片尾或同时添加）。

4. **设置显卡类型**：
   - 根据您的硬件配置选择合适的显卡类型。
   - 若使用集成显卡，请选择“集成核显”。

5. **设置自定义参数**：
   - 分辨率：选择 `720p`、`1080p` 或 `4k`。
   - 帧率：输入输出视频的目标帧率（如 30、60）。
   - 码率：设置输出视频的码率（建议 1000~5000kbps）。

6. **选择屏幕方向**：
   - 横屏或竖屏，适配不同设备。

7. **选择输出文件夹**：
   - 点击“浏览”按钮，设置处理后视频的存储位置。

8. **开始处理**：
   - 点击“开始处理”按钮，程序开始批量处理。
   - 程序会在状态标签中动态显示处理进度。
   - 处理完成后，状态标签会提示“所有视频处理完成”。

---

#### **注意事项**

1. **文件要求**：
   - 主视频、片头、片尾文件必须为 `*.mp4`, `*.mkv`, 或 `*.avi` 格式。
   - 文件名中避免使用特殊字符或空格。

2. **显卡驱动**：
   - 确保显卡驱动版本较新，以支持 GPU 编码功能。

3. **路径要求**：
   - 输入文件夹和输出文件夹路径建议为英文路径，避免中文和特殊字符。

4. **封装的 FFmpeg 工具**：
   - 程序已内置 FFmpeg，无需额外安装。

---

#### **程序打包与运行**

1. **打包命令**：
   使用 `PyInstaller` 进行打包：
   ```bash
   pyinstaller --onefile --windowed --icon="OIG.ico" 加片头片尾36.py
   ```

2. **内置 FFmpeg 路径**：
   确保以下目录结构正确：
   ```
   加片头片尾36/
   ├── ffmpeg/
   │   └── bin/
   │       ├── ffmpeg.exe
   │       └── ffprobe.exe
   ├── 加片头片尾36.py
   └── OIG.ico
   ```

3. **运行方式**：
   打包完成后，生成的 `加片头片尾36.exe` 即为可执行文件，双击运行。

---

#### **常见问题**

1. **无法找到 ffmpeg/ffprobe**：
   - 确保打包时 FFmpeg 工具位于指定路径。

2. **状态标签无更新**：
   - 确保界面函数 `update_status` 在关键步骤处调用。

3. **处理失败**：
   - 检查输入文件格式、路径是否正确。
   - 确保显卡类型与驱动匹配。

---

通过本软件，您可以快速高效地为视频批量添加片头、片尾，并输出符合规格的高质量视频文件！
